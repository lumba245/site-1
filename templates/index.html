{% extends 'base.html' %}

{% block title %}Главная{% endblock %}

{% block content %}


    <!-- Начало банера 1 -->
    <div class="banner-wrapper bg-light">
        <div id="index_banner" class="banner-vertical-center-index container-fluid pt-5">

            <!-- Слайдер -->
            <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
                <ol class="carousel-indicators">
                    <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"></li>
                    <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"></li>
                    <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"></li>
                </ol>
                <div class="carousel-inner">
                    <div class="carousel-item active">

                        <div class="py-5 row d-flex align-items-center">
                            <div class="banner-content col-lg-8 col-8 offset-2 m-lg-auto text-left py-5 pb-5">
                                <h1 class="banner-heading h1 text-secondary display-3 mb-0 pb-5 mx-0 px-0 light-300 typo-space-line">
                                    Компания <strong>ЦАРСКАЯ ПЛИТКА</strong>
                                </h1>
                                <p class="banner-body py-3 mx-0 px-0">
                                    <h3 class="banner-heading h3 text-start display-5 mb-0 pb-5 mx-0 px-0 light-300">Наилучшие цены на тротуарную плитку предоставляются в Ногинском районе, городах Балашиха, Щёлково, Павловский Посад, Электрогорск и Электросталь.</h3>
                                </p>
                                <button class="banner-button btn rounded-pill btn-outline-primary btn-lg px-4"onclick="openOrderModal()">Оформить заказ</button>
                            </div>
                        </div>

                    </div>
                    <div class="carousel-item">

                        <div class="py-5 row d-flex align-items-center">
                            <div class="banner-content col-lg-8 col-8 offset-2 m-lg-auto text-left py-5 pb-5">
                                <h1 class="banner-heading h1 text-secondary display-3 mb-0 pb-5 mx-0 px-0 light-300 typo-space-line">
                                    Компания <strong>ЦАРСКАЯ ПЛИТКА</strong>
                                </h1>
                                <p class="banner-body py-3 mx-0 px-0">
                                    <h3 class="banner-heading h3 text-start display-5 mb-0 pb-5 mx-0 px-0 light-300">Компания "ЦАРСКАЯ ПЛИТКА" специализируется на производстве тротуарной плитки и бордюрного камня</h3>
                                </p>
                                <a class="banner-button btn rounded-pill btn-outline-primary btn-lg px-4" href="{{ url_for('gallery') }}" role="button">Посмотреть работы</a>
                            </div>
                        </div>

                    </div>
                    <div class="carousel-item">

                        <div class="py-5 row d-flex align-items-center">
                            <div class="banner-content col-lg-8 col-8 offset-2 m-lg-auto text-left py-5 pb-5">
                                <h1 class="banner-heading h1 text-secondary display-3 mb-0 pb-5 mx-0 px-0 light-300 typo-space-line">
                                    Компания <strong>ЦАРСКАЯ ПЛИТКА</strong> 
                                </h1>
                                <p class="banner-body py-3 mx-0 px-0">
                                    <h3 class="banner-heading h3 text-start display-5 mb-0 pb-5 mx-0 px-0 light-300">Компания, предоставляющая высококачественную тротуарную плитку, активно следит за разнообразием своего продукта, который подходит для различных целей.</h3>
                                </p>
                                <a href="#sort"><button class="banner-button btn rounded-pill btn-outline-primary btn-lg px-4">К товарам</button></a>
                            </div>
                        </div>

                    </div>
                </div>
                <a class="carousel-control-prev text-decoration-none" href="#carouselExampleIndicators" role="button" data-bs-slide="prev">
                    <i class='bx bx-chevron-left'></i>
                    <span class="visually-hidden">Previous</span>
                </a>
                <a class="carousel-control-next text-decoration-none" href="#carouselExampleIndicators" role="button" data-bs-slide="next">
                    <i class='bx bx-chevron-right'></i>
                    <span class="visually-hidden">Next</span>
                </a>
            </div>
            <!-- Конец слайдера-->

        </div>
    </div>
    <!-- Конец банера 1 -->



<!-- Контейнеры с иконками -->
    <div class="container my-5">
        <div class="row text-center" >

            <!-- Блок 1 -->
            <div class="col-md-4">
                <div class="icon-container">
                    <img class="bx bx-icon-name bx-sm" src="{{ url_for('static', filename='img/shipped.png') }}" alt="Example Image">
                    <i class="bi bi-alarm"></i>
                    <h3>Бесплатная доставка</h3>
                    <p>Для заказов от ₽ 20000</p>
                </div>
            </div>

            <!-- Блок 2 -->
            <div class="col-md-4">
                <div class="icon-container">
                    <img class="bx bx-icon-name bx-sm" src="{{ url_for('static', filename='img/24-hours.png') }}" alt="Example Image">
                    <i class="bx bx-icon-name"></i>
                    <h3>Поддержка 24/7</h3>
                    <p>Звоните нам в любое время</p>
                </div>
            </div>
            
            <!-- Блок 3 -->
            <div class="col-md-4">
                <div class="icon-container">
                    <img class="bx bx-icon-name bx-sm" src="{{ url_for('static', filename='img/tape-measure.png') }}" alt="Example Image">
                    <i class="bx bx-icon-name"></i>
                    <h3>Бесплатный замер</h3>
                    <p>Мастер выезжает и делает замеры</p>
                </div>
            </div>
            <!-- Блок 4 -->
            <!-- <div class="col-md-4">
                <div class="icon-container">
                    <img class="bx bx-icon-name bx-sm" src="{{ url_for('static', filename='img/secure.png') }}" alt="Example Image">
                    <i class="bx bx-icon-name"></i>
                    <h3>100% надежность</h3>
                    <p>Только надежные доставки</p>
                </div>
            </div> -->
        </div>
    </div>
<!-- Конец иконок -->

<!-- Навигация -->
<div class="service-tag py-5 bg-secondary" id="sort">
    <div class="col-md-12">
        <ul class="nav d-flex justify-content-center">
            <li class="nav-item mx-lg-4">
                <a class="filter-btn nav-link btn-outline-primary active shadow rounded-pill text-light px-4 light-300" href="#" data-filter="all">Все товары</a>
            </li>
            {% for category in categories %}
                <li class="nav-item mx-lg-4">
                    <a class="filter-btn nav-link btn-outline-primary rounded-pill text-light px-4 light-300" href="#" data-filter="{{ category[0] }}">{{ category[0] }}</a>
                </li>
            {% endfor %}
        </ul>
    </div>
</div>


<!-- Ваш блок с товарами -->
<section class="container py-5">
    <div class="row" id="items-container">
        {% for el in items %}
        <div class="col-md-3 mb-4 item" data-category="{{ el.category }}">
            <div class="card">
                <div style="width: 100%; padding-top: 100%; position: relative;">
                    <img src="{{ url_for('static', filename='img/gal/' + el.image) }}" class="card-img-top img-fluid" alt="Товар" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
                </div>
                <div class="card-body">
                    <h4 class="card-title">{{ el.title }}</h4>
                    <p class="card-text lead">Метод производства: {{ el.method_1 }}</p>
                    <p class="card-text"><strong>Цена за 1м²: <span class="text-success h5">{{ el.price }} руб.</span></strong></p>
                    <button class="btn btn-primary" data-toggle="modal" data-target="#detailsModal{{ loop.index }}">Подробнее</button>
                    <button class="btn btn-success" onclick="openOrderModal('{{ el.title }}')">Оформить заказ</button>
                </div>
            </div>
        </div>
    
    

            <!-- Модальное окно для подробной информации о товаре -->
            <div class="modal fade" id="detailsModal{{ loop.index }}" tabindex="-1" role="dialog" aria-labelledby="detailsModalLabel{{ loop.index }}" aria-hidden="true">
                <div class="modal-dialog modal-lg custom-modal" role="document">
                    <div class="modal-content">
                        <div class="modal-header bg-primary text-white">
                            <h3 class="modal-title" id="detailsModalLabel{{ loop.index }}">{{ el.title }}</h3>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-6 border-right">
                                    <img src="{{ url_for('static', filename='img/gal/' + el.image) }}" class="img-fluid rounded" alt="Product Image">
                                </div>
                                <div class="col-md-6">
                                    <p><strong>Метод производства:</strong> {{ el.method_1 }}</p>
                                    <hr>
                                    <p><strong>Размеры:</strong> {{ el.sizes }}</p>
                                    <hr>
                                    <p><strong>В 1 м²:</strong> {{ el.in_1_m }}</p>
                                    <hr>
                                    <p><strong>Марка прочности:</strong> {{ el.marka }}</p>
                                    <hr>
                                    <p><strong>Влагопоглощение:</strong> {{ el.vlaga }}</p>
                                    <hr>
                                    <p><strong>Истираемость:</strong> {{ el.istiraem }}</p>
                                    <hr>
                                    <p><strong>Цена: </strong>{{ el.price }} руб.</p>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        </div>
                    </div>
                </div>
            </div>
            
        {% endfor %}

    </div>
</section>















<div class="modal" id="orderModal" tabindex="-1" aria-labelledby="orderModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="orderModalLabel">Оформление заказа</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="orderForm">
                    <p class="selected-product">Выбранный товар: <span id="selectedProductTitle"></span></p>
                    <div class="mb-3">
                        <label for="name" class="form-label">Имя:</label>
                        <input type="text" class="form-control" id="name" name="name" required>
                    </div>
                    <div class="mb-3">
                        <label for="phone" class="form-label">Номер телефона:</label>
                        <input type="text" class="form-control" id="phone" name="phone" required>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="submitOrder()">Отправить заказ</button>
                </form>
            </div>
        </div>
    </div>
</div>






<!-- Подключение Bootstrap JS (необходимо для работы модального окна) -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>







    <!-- Наши работы -->
    <section class="bg-secondary">
        <div class="container py-5">
            <div class="row d-flex justify-content-center text-center">
                <div class="col-lg-2 col-12 text-light align-items-center">
                    <i class='display-1 bx bxs-box bx-lg'></i>
                </div>
                <div class="col-lg-7 col-12 text-light pt-2">
                    <h3 class="h4 semi-bold-600">Установка тротуарной плитки</h3>
                    <p class="light-300">Прокладка тротуарной плитки из брусчатки широко востребована при оформлении как городских, так и частных территорий благоустройства.</p>
                </div>
                <div class="col-lg-3 col-12 pt-4">
                    <a href="{{ url_for('work') }}" class="btn btn-primary rounded-pill btn-block shadow px-4 py-2">Посмотреть наши работы</a>
                </div>
            </div>
        </div>
    </section>
    <!-- End работы -->

    <!-- Последние -->
    <section class="py-5 mb-5">
        <div class="container">
            <div class="recent-work-header row text-center pb-5">
                <h2 class="col-md-6 m-auto h2 semi-bold-600 py-5">Смотрите так же</h2>
            </div>
            <div class="row gy-5 g-lg-5 mb-4">

                <!-- Start Recent Work -->
                <div class="col-md-4 mb-3">
                    <a href="{{ url_for('work_single') }}" class="recent-work card border-0 shadow-lg overflow-hidden">
                        <!-- <img class="recent-work-img card-img" src="./assets/img/recent-work-01.jpg" alt="Card image"> -->
                        <img class="recent-work-img card-img" src="{{ url_for('static', filename='img/recent-work-01.png') }}" alt="Example Image">

                        <div class="recent-work-vertical card-img-overlay d-flex align-items-end">
                            <div class="recent-work-content text-start mb-3 ml-3 text-dark">
                                <h3 class="card-title light-300">Укладка плитки</h3>
                                <p class="card-text">Ullamco laboris nisi ut aliquip ex</p>
                            </div>
                        </div>
                    </a>
                </div><!-- End Recent Work -->

                <!-- Start Recent Work -->
                <div class="col-md-4 mb-3">
                    <a href="{{ url_for('work_single_2') }}" class="recent-work card border-0 shadow-lg overflow-hidden">
                        <!-- <img class="recent-work-img card-img" src="./assets/img/recent-work-02.jpg" alt="Card image"> -->
                        <img class="recent-work-img card-img" src="{{ url_for('static', filename='img/recent-work-02.png') }}" alt="Example Image">

                        <div class="recent-work-vertical card-img-overlay d-flex align-items-end">
                            <div class="recent-work-content text-start mb-3 ml-3 text-dark">
                                <h3 class="card-title light-300">Установка бордюров</h3>
                                <p class="card-text">Psum officia anim id est laborum.</p>
                            </div>
                        </div>
                    </a>
                </div><!-- End Recent Work -->

                <!-- Start Recent Work -->
                <div class="col-md-4 mb-3">
                    <a href="{{ url_for('work_single_3') }}" class="recent-work card border-0 shadow-lg overflow-hidden">
                        <!-- <img class="recent-work-img card-img" src="./assets/img/recent-work-03.jpg" alt="Card image"> -->
                        <img class="recent-work-img card-img" src="{{ url_for('static', filename='img/recent-work-03.png') }}" alt="Example Image">

                        <div class="recent-work-vertical card-img-overlay d-flex align-items-end">
                            <div class="recent-work-content text-start mb-3 ml-3 text-dark">
                                <h3 class="card-title light-300">Благоустройство территории</h3>
                                <p class="card-text">Sum dolor sit consencutur</p>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </section>
    <!-- End -->




    

<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Обработчик событий для нажатия на категорию
        document.querySelectorAll('.filter-btn').forEach(function(button) {
            button.addEventListener('click', function() {
                const filter = this.getAttribute('data-filter');
                filterItems(filter);
            });
        });

        // Функция фильтрации товаров
        function filterItems(filter) {
            const itemsContainer = document.getElementById('items-container');
            const items = itemsContainer.querySelectorAll('.item');
            
            items.forEach(function(item) {
                const category = item.getAttribute('data-category');

                // Показываем только товары, которые соответствуют выбранной категории или все товары при выборе "Все товары"
                if (filter === 'all' || category === filter) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }
    });
</script>

<script>
    function openOrderModal(title) {
        // Сохраняем название товара
        selectedProductTitle = title;

        // Устанавливаем значение названия товара в элемент формы
        document.getElementById('selectedProductTitle').innerText = selectedProductTitle;

        // Показываем модальное окно
        var orderModal = new bootstrap.Modal(document.getElementById('orderModal'));
        orderModal.show();
    }

    function is_valid_phone(phone) {
        var pattern = /^\+7\d{10}$/;
        return pattern.test(phone);
    }

    function submitOrder() {
        var name = document.getElementById("name").value;
        var phone = document.getElementById("phone").value;

        // Проверка валидности номера телефона
        if (!is_valid_phone(phone)) {
            alert("Некорректный номер телефона. Пожалуйста, введите номер в правильном формате.");
            return;
        }

        // Отправка данных на сервер, включая название товара
        fetch('/submit', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: new URLSearchParams({ name: name, phone: phone, productTitle: selectedProductTitle }),
        })
        .then(response => response.text())
        .then(data => {
            alert(data);

            // Закрытие модального окна
            var orderModal = new bootstrap.Modal(document.getElementById('orderModal'));
            orderModal.hide();

            // Перенаправление пользователя обратно к товарам после успешного заказа
            window.location.href = '/';
        })
        .catch((error) => {
            console.error('Error:', error);
        });
    }
</script>

{% endblock %}